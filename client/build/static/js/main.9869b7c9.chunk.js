(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{147:function(e,t,a){},412:function(e,t,a){"use strict";a.r(t);var n,s=a(0),r=a(30),c=a.n(r),i=(a(147),a(33)),o=a(27),l=a(18),d=a.n(l),j=a(34),u=a(7),b=a(414),m=a(418),h=a(60),p=a.n(h),x=function(e){return JSON.parse(localStorage.getItem(e))},O=function(e){localStorage.removeItem(e)},f=function(){return!(!x("user")||(e="token",!localStorage.getItem(e)))&&x("user");var e},g=a(1),v=function(e){var t=f(),a=Object(s.useState)([]),n=Object(u.a)(a,2),r=n[0],c=n[1];Object(s.useEffect)((function(){return o(),function(){}}),[]);var o=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("/api/users/get",{headers:{authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){var a=e.data.filter((function(e){return e._id!==t._id}));c(a)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsx)("div",{children:e.usersSide?Object(g.jsx)(g.Fragment,{children:Object(g.jsx)("div",{children:Object(g.jsxs)("div",{className:"row",children:[Object(g.jsx)("div",{className:"col-md-3 col-lg-3 col-sm-3 col-3",children:Object(g.jsx)("div",{style:{height:"82vh",overflowY:"auto",position:"fixed",width:"25%"},children:Object(g.jsx)("div",{children:r.map((function(e){return Object(g.jsx)(i.b,{to:"/chat/"+e._id,children:Object(g.jsx)(b.a,{style:{borderTop:"1px solid #eaeaec"},author:Object(g.jsx)("h6",{children:e.fullName}),avatar:Object(g.jsx)(m.a,{src:e.image,alt:e.username})})})}))})})}),Object(g.jsx)("div",{className:"col-md-9 col-lg-9 col-9",style:{borderCollapse:"collapse",position:"relative",height:"100vh"},children:e.children})]})})}):e.children})},y=function(){return Object(g.jsx)(v,{usersSide:!0,children:Object(g.jsx)("h1",{className:"text-center",style:{marginTop:"20vh"},children:"Click on any user to see your chat with him here!"})})},w=a(11),N=a(420),S=a(421),k=a(416),I=a(80),C=a(84),_=a(146),M=a.n(_),z=a(124),T=a.n(z),P=a(211),F=a.n(P),Y=function(e){var t,a=e.match.params.id,r=f(),c=Object(s.useState)(""),o=Object(u.a)(c,2),l=o[0],m=o[1],h=Object(s.useState)([]),x=Object(u.a)(h,2),O=x[0],y=x[1],_=Object(s.useState)(""),z=Object(u.a)(_,2),P=z[0],Y=z[1],E=Object(s.useState)(""),W=Object(u.a)(E,2),D=W[0],A=W[1],B=Object(s.useState)({}),L=Object(u.a)(B,2),q=L[0],J=L[1],R=Object(s.useState)(!1),V=Object(u.a)(R,2),G=V[0],H=V[1],U=Object(s.useState)(""),K=Object(u.a)(U,2),X=K[0],Q=K[1];t="https://chat.herokuapp.com/";var Z=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/chats/ind-chat",{userId:r._id,receiverId:a},{headers:{authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){200===e.status?y(e.data.result):y("")}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("/api/users/get/".concat(a)).then((function(e){J(e.data)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){document.getElementById("myDiv").scrollIntoView({behavior:"smooth"})};Object(s.useEffect)((function(){return(n=F()(t)).emit("join",{userId:r._id,username:r.username},(function(){})),n.emit("Get Online Status",{receiver:a}),n.on("Outputting Online Status",(function(e){A(e)})),n.on("outputting typing",(function(e){e.receiver===r._id&&e.sender===a?Y(e.status):Y("")})),n.on("Output Chat Message",(function(e){var t,n,s,c;console.log(e),(e.receiver===r._id&&(null===e||void 0===e||null===(t=e.sender)||void 0===t?void 0:t._id)===a||(null===e||void 0===e||null===(n=e.sender)||void 0===n?void 0:n._id)===r._id)&&y((function(t){return[].concat(Object(w.a)(t),[e])})),e.receiver===r._id&&(null===e||void 0===e||null===(s=e.sender)||void 0===s?void 0:s._id)===a&&ee(),(null===e||void 0===e||null===(c=e.sender)||void 0===c?void 0:c._id)===f()._id&&ee()})),function(){}}),[t]),Object(s.useEffect)((function(){return Z(),$(),ee(),n.emit("Get Online Status",{receiver:a}),function(){}}),[a]);var te=function(){var e=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),H(!0),Y(""),"Text",e.t0=l,!e.t0){e.next=8;break}return e.next=8,n.emit("Input Chat Message",{message:l,userId:r._id,username:r.username,receiver:a,nowTime:T()().format("dddd, MMMM Do YYYY, h:mm:ss a"),type:"Text"});case 8:m(""),ee(),H(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();setTimeout((function(){Y("")}),2e3);var ae=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.emit("The user is typing....",{username:r.username,receiver:a});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)(v,{usersSide:!0,children:[Object(g.jsx)("div",{className:"chat-body",style:{position:"relative"},children:Object(g.jsx)("div",{className:"header-avatar px-2",style:{background:"whitesmoke",position:"fixed",width:"100%"},children:Object(g.jsx)(b.a,{author:Object(g.jsx)("h6",{className:"mt-1",children:q.fullName}),avatar:Object(g.jsx)(M.a,{src:q.image,alt:q.username}),content:P?Object(g.jsx)("p",{children:P}):Object(g.jsx)("p",{children:D})})})}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{style:{overflowX:"hidden",height:"67vh",overflowY:"auto",marginTop:"223px"},children:[O&&O.map((function(e){return Object(g.jsx)(b.a,{className:e.sender._id===r._id?"sender-chat":"w-50",author:Object(g.jsx)("h6",{children:e.sender.fullName}),avatar:Object(g.jsx)(M.a,{src:e.sender.image,alt:e.sender.username}),content:"http:/"===e.message.substring(0,6)?"mp4"===e.message.substring(e.message.length-3,e.message.length)?(e.sender._id,r._id,Object(g.jsx)("video",{style:{maxWidth:"200px"},src:e.message,controls:!0,alt:"video",type:"video/mp4"})):(e.sender._id,r._id,Object(g.jsx)("img",{src:e.message,alt:"image",style:{maxWidth:"200px"}})):e.sender._id===r._id?Object(g.jsx)(i.b,{className:"text-dark",children:e.message}):Object(g.jsx)("p",{children:e.message}),datetime:Object(g.jsx)("span",{children:T()(e.timeOfSending,"dddd, MMMM Do YYYY, h:mm:ss a").fromNow()})},e._id)})),Object(g.jsx)("div",{id:"myDiv"})]}),Object(g.jsx)("div",{className:"p-2",style:{position:"sticky",bottom:"0px",background:"lightgray"},children:Object(g.jsxs)("div",{className:"d-flex",children:[Object(g.jsx)(k.a,{onKeyPress:function(){return ae()},style:X?{width:"73%"}:{width:"82%"},value:l,placeholder:"Type message here...",allowClear:!0,onChange:function(e){m(e.target.value)}}),Object(g.jsx)("input",{id:"actual-btn",type:"file",name:"file",multiple:!0,onChange:function(e){Q(e.target.files[0])},hidden:!0}),Object(g.jsx)("label",{for:"actual-btn",className:"px-4",children:Object(g.jsx)(I.a,{title:"Choose File",children:Object(g.jsx)(N.a,{style:{fontSize:"23px",cursor:"pointer"}})})}),X?Object(g.jsx)(C.a,{type:"primary",loading:G,onClick:function(){H(!0);var e=new FormData;e.append("file",X);p.a.post("/api/chats/upload-image",e,{headers:{authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){200===e.status&&(n.emit("Input Chat Message",{message:e.data.url,cloudinary_id:e.data.id,userId:r._id,username:r.username,receiver:a,nowTime:T()().format("dddd, MMMM Do YYYY, h:mm:ss a"),type:"VideoOrImage"}),Q(""),H(!1))}))},children:G?Object(g.jsx)("span",{children:"Sending"}):Object(g.jsx)("span",{children:"Send File"})}):Object(g.jsx)(C.a,{type:"primary",loading:G,onClick:te,children:Object(g.jsx)(S.a,{})})]})})]})]})},E=a(8),W=a(2),D=a(422),A=a(423),B=a(424),L=a(215),q=function(e){L.b.success({content:e,duration:1})},J=function(e){L.b.error({content:e,duration:1,style:{marginTop:"100px"}})},R=a.p+"static/media/loading.be4c3671.gif",V=function(){return Object(g.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:Object(g.jsx)("img",{src:R,alt:"Loading",width:"43"})})},G=function(e){var t=Object(s.useState)(!1),a=Object(u.a)(t,2),n=a[0],r=a[1],c=Object(s.useState)({email:"",password:""}),o=Object(u.a)(c,2),l=o[0],b=o[1],m=l.email,h=l.password,x=function(e){b(Object(W.a)(Object(W.a)({},l),{},Object(E.a)({},e.target.name,e.target.value)))},O=function(){var t=Object(j.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.scrollTo(0,0),r(!0),t.next=4,p.a.post("/api/users/login",{email:m,password:h}).then((function(t){var a,n;r(!1),200===t.status?(a=t.data,n=t.data.token,localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("token",n),q(t.data.successMessage),e.history.push("/"),window.location.reload()):(t.status,J(t.data.errorMessage))}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(g.jsx)("div",{children:f()?Object(g.jsxs)("div",{className:"text-center",style:{marginTop:"50vh"},children:[Object(g.jsxs)("h4",{children:[Object(g.jsx)(B.a,{})," ",Object(g.jsx)("br",{}),"You are already Logged in!"]}),Object(g.jsx)(i.b,{to:"/",className:"btn my-2 mt-2",style:{width:"202px",background:"rgba(130, 36, 227, 0.8)",color:"white"},children:"Go to Home"})]}):n?Object(g.jsx)(V,{}):Object(g.jsx)(g.Fragment,{children:Object(g.jsx)("div",{className:"auth-form",children:Object(g.jsx)("div",{className:"auth-form-inner",children:Object(g.jsx)("div",{style:{padding:"60px"},children:Object(g.jsx)("div",{className:"login-right text-center",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"mb-3 text-center ml-4",children:Object(g.jsx)(i.b,{style:{color:"rgba(130, 36, 227, 0.8)",fontSize:"32px",fontWeight:"700",paddingBottom:"300px"},to:"/",children:"Chat App"})}),Object(g.jsx)("p",{className:"mb-2",style:{fontSize:"20px",fontWeight:"680",color:"#424553"},children:"Welcome!"}),Object(g.jsx)("p",{children:"Join and chat with your friends"}),Object(g.jsxs)("form",{onSubmit:O,children:[Object(g.jsx)("div",{className:"floating-label-group mb-3",children:Object(g.jsx)(k.a,{name:"email",onChange:x,size:"small",placeholder:"Email or Username",prefix:Object(g.jsx)(D.a,{})})}),Object(g.jsx)("div",{className:"floating-label-group",children:Object(g.jsx)(k.a.Password,{name:"password",type:"password",onChange:x,size:"small",placeholder:"Password",prefix:Object(g.jsx)(A.a,{})})}),Object(g.jsx)("button",{type:"submit",className:"btn my-2 mt-3 w-100",style:{padding:"10px",background:"rgba(130, 36, 227, 0.8)",color:"white",borderRadius:"23px"},children:"Login"})]}),Object(g.jsx)("div",{className:"mt-2",children:Object(g.jsxs)("p",{children:["New to ",Object(g.jsx)("strong",{children:"Chat App?"})," ",Object(g.jsx)(i.b,{to:"/signup",style:{color:"rgba(130, 36, 227, 0.8)",fontWeight:"631"},children:"Register"})]})})]})})})})})})})},H=a(415),U=a(425),K=a(426),X=function(e){var t=Object(s.useState)(!1),a=Object(u.a)(t,2),n=a[0],r=a[1],c=Object(s.useState)(""),o=Object(u.a)(c,2),l=o[0],b=o[1],m=Object(s.useState)({fullName:"",email:"",username:"",password:"",confimPassword:""}),h=Object(u.a)(m,2),x=h[0],O=h[1],f=x.fullName,v=x.username,y=x.email,w=x.password,N=function(e){O(Object(W.a)(Object(W.a)({},x),{},Object(E.a)({},e.target.name,e.target.value)))},S=function(){var t=Object(j.a)(d.a.mark((function t(a){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.scrollTo(0,0),r(!0),(n=new FormData).append("fullName",f),n.append("email",y),n.append("username",v),n.append("password",w),n.append("file",l),t.next=10,p.a.post("/api/users/signup",n).then((function(t){r(!1),200===t.status?(q(t.data.successMessage),setTimeout((function(){e.history.push("/login")}),2e3)):201===t.status?J(t.data.ErrorMessageMessage):J(t.data.errorMessage)}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return n?Object(g.jsx)(V,{}):Object(g.jsx)("div",{className:"auth-form",children:Object(g.jsx)("div",{className:"auth-form-inner",children:Object(g.jsx)("div",{className:"signup-right text-center",children:Object(g.jsxs)("div",{className:"px-5",children:[Object(g.jsx)("div",{className:"mb-3 text-center ml-4",children:Object(g.jsx)(i.b,{style:{color:"rgba(130, 36, 227, 0.8)",fontSize:"32px",fontWeight:"700",paddingBottom:"300px"},to:"/",children:"Chat App"})}),Object(g.jsx)("p",{children:"Join and chat with your friends"}),Object(g.jsxs)(H.a,{name:"basic",initialValues:{remember:!0},onFinish:S,children:[Object(g.jsx)("div",{className:"floating-label-group",children:Object(g.jsx)(H.a.Item,{name:"Full Name",rules:[{required:!0,message:"Please input your Full Name!"}],children:Object(g.jsx)(k.a,{name:"fullName",onChange:N,size:"small",placeholder:"Full Name",prefix:Object(g.jsx)(U.a,{})})})}),Object(g.jsx)("div",{className:"floating-label-group",children:Object(g.jsx)(H.a.Item,{name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(g.jsx)(k.a,{name:"username",type:"text",onChange:N,size:"small",placeholder:"Username",prefix:Object(g.jsx)(D.a,{})})})}),Object(g.jsx)("div",{className:"floating-label-group",children:Object(g.jsx)(H.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(g.jsx)(k.a,{name:"email",onChange:N,size:"small",placeholder:"Email",prefix:Object(g.jsx)(K.a,{})})})}),Object(g.jsx)("div",{className:"floating-label-group",children:Object(g.jsx)(H.a.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],hasFeedback:!0,children:Object(g.jsx)(k.a.Password,{type:"password",name:"password",onChange:N,size:"small",placeholder:"Password",prefix:Object(g.jsx)(A.a,{})})})}),Object(g.jsx)("div",{className:"floating-label-group",children:Object(g.jsx)(H.a.Item,{name:"confirm",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("password")!==a?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(g.jsx)(k.a.Password,{name:"confimPassword",onChange:N,size:"small",placeholder:"Re-Enter Password",prefix:Object(g.jsx)(A.a,{})})})}),Object(g.jsxs)("div",{className:"floating-label-group my-3",children:[Object(g.jsx)("label",{for:"formFile",className:"form-label mb-2 fw-bolder",children:"Select profile picture"}),Object(g.jsx)("input",{className:"form-control",type:"file",name:"file",onChange:function(e){b(e.target.files[0])},id:"formFile",required:!0})]}),Object(g.jsx)("button",{type:"submit",className:"btn my-2 mt-3 w-100",style:{padding:"10px",background:"rgba(130, 36, 227, 0.8)",color:"white",borderRadius:"23px"},children:"Create Account"})]}),Object(g.jsx)("div",{className:"mt-2",children:Object(g.jsxs)("p",{children:["Already Have Account? ",Object(g.jsx)(i.b,{to:"/login",style:{color:"rgba(130, 36, 227, 0.8)",fontWeight:"631"},children:"Login"})]})})]})})})})},Q=a(417),Z=a(419),$=function(){var e=Object(g.jsx)("div",{className:"navMenu",children:f()?Object(g.jsxs)(Q.a,{children:[Object(g.jsx)(Q.a.Item,{children:Object(g.jsx)("h6",{className:"p-2 bg-light",children:f().fullName})},"1"),Object(g.jsx)(Q.a.Item,{children:Object(g.jsx)("a",{href:"/login",onClick:function(e){var t;t=function(){},O("user"),O("token"),t()},children:"Logout"})},"4")]}):Object(g.jsxs)(Q.a,{style:{padding:"10px",textAlign:"center"},children:[Object(g.jsx)("h6",{children:"Welcome"}),Object(g.jsxs)(Q.a.Item,{children:[Object(g.jsx)(i.b,{to:"/login",className:"px-4 login-btn",style:{border:"1px solid rgba(130, 36, 227, 0.8)",color:"rgba(130, 36, 227, 0.8)",padding:"8px",fontWeight:"500",fontSize:"14px"},children:"Login/Signup"}),Object(g.jsx)("div",{style:{borderBottom:"1px solid #eaeaec",paddingTop:"20px"}})]})]})});return Object(g.jsx)("div",{className:"main-nav",children:Object(g.jsxs)("nav",{className:"navbar fixed-top",children:[Object(g.jsx)(i.b,{className:"navbar-brand",to:"/",style:{color:"rgba(130, 36, 227, 0.8)",fontSize:"43px",fontWeight:"700"},children:"Chat App"}),Object(g.jsx)("div",{children:Object(g.jsx)("ul",{className:"navbar-nav ml-auto mr-5 list-unstyle pt-3",style:{fontSize:"12px"},children:Object(g.jsx)("li",{className:"nav-item profile",style:{fontWeight:"normal"},children:Object(g.jsx)(Z.a,{overlay:e,children:f()?Object(g.jsx)(i.b,{children:Object(g.jsx)("img",{src:f().image,width:"43",height:"43",alt:"image",className:"rounded-circle"})}):Object(g.jsxs)("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:[Object(g.jsx)(D.a,{style:{fontSize:"21px",paddingLeft:"10px",color:"black"}}),Object(g.jsx)("br",{}),Object(g.jsx)("span",{style:{fontSize:"14px",color:"black"},children:"Profile"})]})})})})})]})})},ee=a(21),te=function(e){var t=e.component,a=Object(ee.a)(e,["component"]);return Object(g.jsx)(o.b,Object(W.a)(Object(W.a)({},a),{},{render:function(e){return f()?Object(g.jsx)(t,Object(W.a)({},e)):Object(g.jsx)(o.a,{to:"/login"})}}))},ae=function(){return Object(g.jsx)("div",{children:Object(g.jsx)(i.a,{children:Object(g.jsxs)("div",{children:[Object(g.jsx)($,{}),Object(g.jsx)("div",{style:{marginTop:"100px"},children:Object(g.jsxs)(o.d,{children:[Object(g.jsx)(o.b,{exact:!0,path:"/login",component:G}),Object(g.jsx)(o.b,{exact:!0,path:"/signup",component:X}),Object(g.jsx)(te,{exact:!0,path:"/",component:y}),Object(g.jsx)(te,{exact:!0,path:"/chat/:id",component:Y})]})})]})})})};c.a.render(Object(g.jsx)(ae,{}),document.getElementById("root"))}},[[412,1,2]]]);
//# sourceMappingURL=main.9869b7c9.chunk.js.map